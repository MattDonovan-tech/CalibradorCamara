//
//  jacobianCalculation.hpp
//  
//
//  Created by David Choqueluque Roman on 2/10/19.
//

#ifndef jacobianCalculation_hpp
#define jacobianCalculation_hpp

#include <stdio.h>
//
// file : jacobianCalculation.h
//---------------------------------------------------
// this file contains a function that calculates
// Jacobian form that is required in LM algorithm
// for camera calibration
//
void CalculateJocobian(double *Jx, double *Jy, int imageNum, int len,
                       double X, double Y,
                       double au, double av, double u0, double v0, double sk,
                       double wx, double wy, double wz,
                       double tx, double ty, double tz, double k1, double k2);
double Jx1(double X, double Y, double au, double av, double u0, double v0,
           double sk, double wx, double wy, double wz,
           double tx, double ty, double tz, double k1, double k2){
    return -(tx-Y*(wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wy*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+X*(((cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*(wy*wy+wz*wz))/(wx*wx+wy*wy+wz*wz)+1.0))/(tz-X*(wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+Y*(wx*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)));
}
double Jx2(double X, double Y, double au, double av, double u0, double v0, //0.0
           double sk, double wx, double wy, double wz,
           double tx, double ty, double tz, double k1, double k2){
    retunr 0;
}
double Jx3(double X, double Y, double au, double av, double u0, double v0,
           double sk, double wx, double wy, double wz,
           double tx, double ty, double tz, double k1, double k2);//0.0

double Jx4(double X, double Y, double au, double av, double u0, double v0,//-1.0
           double sk, double wx, double wy, double wz,
           double tx, double ty, double tz, double k1, double k2);
double Jx5(double X, double Y, double au, double av, double u0, double v0,
           double sk, double wx, double wy, double wz,
           double tx, double ty, double tz, double k1, double k2){
    return -(ty+X*(wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wx*wy*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+Y*(((cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*(wx*wx+wz*wz))/(wx*wx+wy*wy+wz*wz)+1.0))/(tz-X*(wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+Y*(wx*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)));
}
double Jx6(double X, double Y, double au, double av, double u0, double v0,
           double sk, double wx, double wy, double wz,
           double tx, double ty, double tz, double k1, double k2){
    return -(X*(-au*(wx*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*(wy*wy+wz*wz)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0+wx*sin(sqrt(wx*wx+wy*wy+wz*wz))*(wy*wy+wz*wz)*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0))+sk*(-(wy*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)+(wx*wz*cos(sqrt(wx*wx+wy*wy+wz*wz)))/(wx*wx+wy*wy+wz*wz)-wx*wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+(wx*wx)*wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+(wx*wx)*wy*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0)+u0*(-(wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)-(wx*wy*cos(sqrt(wx*wx+wy*wy+wz*wz)))/(wx*wx+wy*wy+wz*wz)+wx*wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+(wx*wx)*wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+(wx*wx)*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0))+Y*(-sk*((wx*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*-2.0)/(wx*wx+wy*wy+wz*wz)+wx*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*(wx*wx+wz*wz)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0+wx*sin(sqrt(wx*wx+wy*wy+wz*wz))*(wx*wx+wz*wz)*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0))+au*(-(wy*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)-(wx*wz*cos(sqrt(wx*wx+wy*wy+wz*wz)))/(wx*wx+wy*wy+wz*wz)+wx*wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+(wx*wx)*wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+(wx*wx)*wy*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0)+u0*(sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+((wx*wx)*cos(sqrt(wx*wx+wy*wy+wz*wz)))/(wx*wx+wy*wy+wz*wz)-(wx*wx)*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+wx*wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0+wx*wy*wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0))))/(tz-X*(wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+Y*(wx*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)))+(X*(-(wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)-(wx*wy*cos(sqrt(wx*wx+wy*wy+wz*wz)))/(wx*wx+wy*wy+wz*wz)+wx*wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+(wx*wx)*wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+(wx*wx)*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0)+Y*(sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+((wx*wx)*cos(sqrt(wx*wx+wy*wy+wz*wz)))/(wx*wx+wy*wy+wz*wz)-(wx*wx)*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+wx*wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0+wx*wy*wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)))*1.0/pow(tz-X*(wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+Y*(wx*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)),2.0)*(X*(sk*(wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wx*wy*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))-u0*(wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+au*(((cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*(wy*wy+wz*wz))/(wx*wx+wy*wy+wz*wz)+1.0))+Y*(-au*(wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wy*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+u0*(wx*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+sk*(((cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*(wx*wx+wz*wz))/(wx*wx+wy*wy+wz*wz)+1.0))+au*tx+sk*ty+tz*u0);
}
double Jx7(double X, double Y, double au, double av, double u0, double v0,
           double sk, double wx, double wy, double wz,
           double tx, double ty, double tz, double k1, double k2){
    return -(Y*(-sk*(wy*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*(wx*wx+wz*wz)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0+wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*(wx*wx+wz*wz)*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0))+au*(-(wx*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)-(wy*wz*cos(sqrt(wx*wx+wy*wy+wz*wz)))/(wx*wx+wy*wy+wz*wz)+wy*wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+wx*(wy*wy)*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+wx*(wy*wy)*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0)+u0*(-(wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)+(wx*wy*cos(sqrt(wx*wx+wy*wy+wz*wz)))/(wx*wx+wy*wy+wz*wz)-wx*wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+(wy*wy)*wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+(wy*wy)*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0))+X*(-au*((wy*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*-2.0)/(wx*wx+wy*wy+wz*wz)+wy*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*(wy*wy+wz*wz)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0+wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*(wy*wy+wz*wz)*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0))+sk*(-(wx*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)+(wy*wz*cos(sqrt(wx*wx+wy*wy+wz*wz)))/(wx*wx+wy*wy+wz*wz)-wy*wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+wx*(wy*wy)*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+wx*(wy*wy)*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0)+u0*(-sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-((wy*wy)*cos(sqrt(wx*wx+wy*wy+wz*wz)))/(wx*wx+wy*wy+wz*wz)+(wy*wy)*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+wx*wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0+wx*wy*wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0))))/(tz-X*(wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+Y*(wx*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)))+(Y*(-(wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)+(wx*wy*cos(sqrt(wx*wx+wy*wy+wz*wz)))/(wx*wx+wy*wy+wz*wz)-wx*wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+(wy*wy)*wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+(wy*wy)*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0)+X*(-sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-((wy*wy)*cos(sqrt(wx*wx+wy*wy+wz*wz)))/(wx*wx+wy*wy+wz*wz)+(wy*wy)*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+wx*wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0+wx*wy*wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)))*1.0/pow(tz-X*(wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+Y*(wx*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)),2.0)*(X*(sk*(wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wx*wy*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))-u0*(wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+au*(((cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*(wy*wy+wz*wz))/(wx*wx+wy*wy+wz*wz)+1.0))+Y*(-au*(wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wy*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+u0*(wx*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+sk*(((cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*(wx*wx+wz*wz))/(wx*wx+wy*wy+wz*wz)+1.0))+au*tx+sk*ty+tz*u0);
}
double Jx8(double X, double Y, double au, double av, double u0, double v0,
           double sk, double wx, double wy, double wz,
           double tx, double ty, double tz, double k1, double k2){
    return -(X*(-au*((wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*-2.0)/(wx*wx+wy*wy+wz*wz)+wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*(wy*wy+wz*wz)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0+wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*(wy*wy+wz*wz)*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0))+u0*(-(wx*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)-(wy*wz*cos(sqrt(wx*wx+wy*wy+wz*wz)))/(wx*wx+wy*wy+wz*wz)+wy*wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+wx*(wz*wz)*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+wx*(wz*wz)*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0)+sk*(sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+((wz*wz)*cos(sqrt(wx*wx+wy*wy+wz*wz)))/(wx*wx+wy*wy+wz*wz)-(wz*wz)*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+wx*wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0+wx*wy*wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)))+Y*(-sk*((wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*-2.0)/(wx*wx+wy*wy+wz*wz)+wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*(wx*wx+wz*wz)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0+wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*(wx*wx+wz*wz)*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0))+u0*(-(wy*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)+(wx*wz*cos(sqrt(wx*wx+wy*wy+wz*wz)))/(wx*wx+wy*wy+wz*wz)-wx*wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+wy*(wz*wz)*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+wy*(wz*wz)*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0)+au*(-sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-((wz*wz)*cos(sqrt(wx*wx+wy*wy+wz*wz)))/(wx*wx+wy*wy+wz*wz)+(wz*wz)*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+wx*wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0+wx*wy*wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0))))/(tz-X*(wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+Y*(wx*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)))+(X*(-(wx*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)-(wy*wz*cos(sqrt(wx*wx+wy*wy+wz*wz)))/(wx*wx+wy*wy+wz*wz)+wy*wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+wx*(wz*wz)*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+wx*(wz*wz)*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0)+Y*(-(wy*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)+(wx*wz*cos(sqrt(wx*wx+wy*wy+wz*wz)))/(wx*wx+wy*wy+wz*wz)-wx*wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+wy*(wz*wz)*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+wy*(wz*wz)*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0))*1.0/pow(tz-X*(wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+Y*(wx*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)),2.0)*(X*(sk*(wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wx*wy*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))-u0*(wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+au*(((cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*(wy*wy+wz*wz))/(wx*wx+wy*wy+wz*wz)+1.0))+Y*(-au*(wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wy*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+u0*(wx*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+sk*(((cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*(wx*wx+wz*wz))/(wx*wx+wy*wy+wz*wz)+1.0))+au*tx+sk*ty+tz*u0);
}
double Jx9(double X, double Y, double au, double av, double u0, double v0,
           double sk, double wx, double wy, double wz,
           double tx, double ty, double tz, double k1, double k2){
    return -au/(tz-X*(wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+Y*(wx*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)));
}
double Jx10(double X, double Y, double au, double av, double u0, double v0,
           double sk, double wx, double wy, double wz,
            double tx, double ty, double tz, double k1, double k2){
    return -sk/(tz-X*(wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+Y*(wx*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)));
}
double Jx11(double X, double Y, double au, double av, double u0, double v0,
           double sk, double wx, double wy, double wz,
            double tx, double ty, double tz, double k1, double k2){
    return -u0/(tz-X*(wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+Y*(wx*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)))+1.0/pow(tz-X*(wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+Y*(wx*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)),2.0)*(X*(sk*(wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wx*wy*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))-u0*(wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+au*(((cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*(wy*wy+wz*wz))/(wx*wx+wy*wy+wz*wz)+1.0))+Y*(-au*(wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wy*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+u0*(wx*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+sk*(((cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*(wx*wx+wz*wz))/(wx*wx+wy*wy+wz*wz)+1.0))+au*tx+sk*ty+tz*u0);
}

double Jy1(double X, double Y, double au, double av, double u0, double v0,//0.0
            double sk, double wx, double wy, double wz,
            double tx, double ty, double tz, double k1, double k2);
double Jy2(double X, double Y, double au, double av, double u0, double v0,
            double sk, double wx, double wy, double wz,
           double tx, double ty, double tz, double k1, double k2){
    return -(ty+X*(wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wx*wy*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+Y*(((cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*(wx*wx+wz*wz))/(wx*wx+wy*wy+wz*wz)+1.0))/(tz-X*(wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+Y*(wx*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)));
}
double Jy3(double X, double Y, double au, double av, double u0, double v0,//0.0
            double sk, double wx, double wy, double wz,
            double tx, double ty, double tz, double k1, double k2);
double Jy4(double X, double Y, double au, double av, double u0, double v0,//1.0
            double sk, double wx, double wy, double wz,
            double tx, double ty, double tz, double k1, double k2);
double Jy5(double X, double Y, double au, double av, double u0, double v0,//0.0
            double sk, double wx, double wy, double wz,
            double tx, double ty, double tz, double k1, double k2);
double Jy6(double X, double Y, double au, double av, double u0, double v0,
            double sk, double wx, double wy, double wz,
            double tx, double ty, double tz, double k1, double k2)
{
    return (Y*(av*((wx*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*-2.0)/(wx*wx+wy*wy+wz*wz)+wx*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*(wx*wx+wz*wz)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0+wx*sin(sqrt(wx*wx+wy*wy+wz*wz))*(wx*wx+wz*wz)*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0))-v0*(sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+((wx*wx)*cos(sqrt(wx*wx+wy*wy+wz*wz)))/(wx*wx+wy*wy+wz*wz)-(wx*wx)*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+wx*wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0+wx*wy*wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)))-X*(av*(-(wy*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)+(wx*wz*cos(sqrt(wx*wx+wy*wy+wz*wz)))/(wx*wx+wy*wy+wz*wz)-wx*wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+(wx*wx)*wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+(wx*wx)*wy*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0)+v0*(-(wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)-(wx*wy*cos(sqrt(wx*wx+wy*wy+wz*wz)))/(wx*wx+wy*wy+wz*wz)+wx*wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+(wx*wx)*wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+(wx*wx)*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0)))/(tz-X*(wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+Y*(wx*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)))+(X*(-(wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)-(wx*wy*cos(sqrt(wx*wx+wy*wy+wz*wz)))/(wx*wx+wy*wy+wz*wz)+wx*wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+(wx*wx)*wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+(wx*wx)*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0)+Y*(sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+((wx*wx)*cos(sqrt(wx*wx+wy*wy+wz*wz)))/(wx*wx+wy*wy+wz*wz)-(wx*wx)*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+wx*wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0+wx*wy*wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)))*1.0/pow(tz-X*(wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+Y*(wx*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)),2.0)*(av*ty+X*(av*(wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wx*wy*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))-v0*(wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)))+tz*v0+Y*(v0*(wx*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+av*(((cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*(wx*wx+wz*wz))/(wx*wx+wy*wy+wz*wz)+1.0)));
}
double Jy7(double X, double Y, double au, double av, double u0, double v0,
            double sk, double wx, double wy, double wz,
           double tx, double ty, double tz, double k1, double k2){
    return -(X*(av*(-(wx*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)+(wy*wz*cos(sqrt(wx*wx+wy*wy+wz*wz)))/(wx*wx+wy*wy+wz*wz)-wy*wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+wx*(wy*wy)*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+wx*(wy*wy)*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0)+v0*(-sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-((wy*wy)*cos(sqrt(wx*wx+wy*wy+wz*wz)))/(wx*wx+wy*wy+wz*wz)+(wy*wy)*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+wx*wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0+wx*wy*wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)))-Y*(av*(wy*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*(wx*wx+wz*wz)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0+wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*(wx*wx+wz*wz)*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0))-v0*(-(wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)+(wx*wy*cos(sqrt(wx*wx+wy*wy+wz*wz)))/(wx*wx+wy*wy+wz*wz)-wx*wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+(wy*wy)*wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+(wy*wy)*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0)))/(tz-X*(wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+Y*(wx*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)))+(Y*(-(wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)+(wx*wy*cos(sqrt(wx*wx+wy*wy+wz*wz)))/(wx*wx+wy*wy+wz*wz)-wx*wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+(wy*wy)*wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+(wy*wy)*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0)+X*(-sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-((wy*wy)*cos(sqrt(wx*wx+wy*wy+wz*wz)))/(wx*wx+wy*wy+wz*wz)+(wy*wy)*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+wx*wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0+wx*wy*wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)))*1.0/pow(tz-X*(wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+Y*(wx*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)),2.0)*(av*ty+X*(av*(wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wx*wy*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))-v0*(wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)))+tz*v0+Y*(v0*(wx*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+av*(((cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*(wx*wx+wz*wz))/(wx*wx+wy*wy+wz*wz)+1.0)));
}
double Jy8(double X, double Y, double au, double av, double u0, double v0,
            double sk, double wx, double wy, double wz,
           double tx, double ty, double tz, double k1, double k2){
    return -(X*(v0*(-(wx*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)-(wy*wz*cos(sqrt(wx*wx+wy*wy+wz*wz)))/(wx*wx+wy*wy+wz*wz)+wy*wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+wx*(wz*wz)*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+wx*(wz*wz)*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0)+av*(sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+((wz*wz)*cos(sqrt(wx*wx+wy*wy+wz*wz)))/(wx*wx+wy*wy+wz*wz)-(wz*wz)*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+wx*wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0+wx*wy*wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)))-Y*(av*((wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*-2.0)/(wx*wx+wy*wy+wz*wz)+wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*(wx*wx+wz*wz)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0+wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*(wx*wx+wz*wz)*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0))-v0*(-(wy*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)+(wx*wz*cos(sqrt(wx*wx+wy*wy+wz*wz)))/(wx*wx+wy*wy+wz*wz)-wx*wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+wy*(wz*wz)*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+wy*(wz*wz)*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0)))/(tz-X*(wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+Y*(wx*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)))+(X*(-(wx*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)-(wy*wz*cos(sqrt(wx*wx+wy*wy+wz*wz)))/(wx*wx+wy*wy+wz*wz)+wy*wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+wx*(wz*wz)*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+wx*(wz*wz)*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0)+Y*(-(wy*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)+(wx*wz*cos(sqrt(wx*wx+wy*wy+wz*wz)))/(wx*wx+wy*wy+wz*wz)-wx*wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+wy*(wz*wz)*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/pow(wx*wx+wy*wy+wz*wz,3.0/2.0)+wy*(wz*wz)*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*1.0/pow(wx*wx+wy*wy+wz*wz,2.0)*2.0))*1.0/pow(tz-X*(wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+Y*(wx*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)),2.0)*(av*ty+X*(av*(wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wx*wy*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))-v0*(wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)))+tz*v0+Y*(v0*(wx*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+av*(((cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*(wx*wx+wz*wz))/(wx*wx+wy*wy+wz*wz)+1.0)));
}
double Jy9(double X, double Y, double au, double av, double u0, double v0,
            double sk, double wx, double wy, double wz,
           double tx, double ty, double tz, double k1, double k2)//0.0
double Jy10(double X, double Y, double au, double av, double u0, double v0,
            double sk, double wx, double wy, double wz,
            double tx, double ty, double tz, double k1, double k2){
   return -av/(tz-X*(wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+Y*(wx*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)));
}

double Jy11(double X, double Y, double au, double av, double u0, double v0,
            double sk, double wx, double wy, double wz,
            double tx, double ty, double tz, double k1, double k2){
    return -v0/(tz-X*(wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+Y*(wx*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)))+1.0/pow(tz-X*(wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+Y*(wx*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)),2.0)*(av*ty+X*(av*(wz*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wx*wy*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))-v0*(wy*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)+(wx*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz)))+tz*v0+Y*(v0*(wx*sin(sqrt(wx*wx+wy*wy+wz*wz))*1.0/sqrt(wx*wx+wy*wy+wz*wz)-(wy*wz*(cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0))/(wx*wx+wy*wy+wz*wz))+av*(((cos(sqrt(wx*wx+wy*wy+wz*wz))-1.0)*(wx*wx+wz*wz))/(wx*wx+wy*wy+wz*wz)+1.0)));
}
#endif /* jacobianCalculation_hpp */
